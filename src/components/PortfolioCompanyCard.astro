---
import clsx from 'clsx';
import { Image as UnpicImage } from '@unpic/astro';
import { resolveImageSrc } from '../lib/images';

interface Props {
  name: string;
  url: string;
  tags: string[];
  slug: string;
}

const { name, url, tags, slug } = Astro.props;

// Companies that need black background for their logos
const blackBackgroundSlugs = ['beta'];

type TagColors = {
  [key: string]: string;
};

const dotColor = 'bg-strong';

const dotColors: TagColors = {
  'ðŸ¦„': 'bg-fuchsia-600',
  aerospace: dotColor,
  hardware: dotColor,
  energy: dotColor,
  'dev tools': dotColor,
  ai: dotColor,
  saas: dotColor,
  construction: dotColor,
  'board seat': dotColor,
  'board seat (past)': dotColor,
  biotech: dotColor,
  'food tech': dotColor,
  cad: dotColor,
  acquired: 'bg-green-600',
};

// Helper function to get tag styles based on category
const getTagStyle = (tag: string) => {
  const baseStyle =
    ' text-xs inline-flex items-center mx-1 gap-1.5 px-3 py-1 rounded-full bg-surface text-muted text-sm border border-default';
  return {
    container: baseStyle,
    dot: `w-1.5 h-1.5 rounded-full ${dotColors[tag.toLowerCase()] || 'bg-gray-400'}`,
  };
};
---

<div class="flex flex-col gap-2 overflow-hidden py-1">
  <a
    href={url}
    target="_blank"
    rel="noopener noreferrer"
    class="text-primary flex min-w-0 items-center gap-3 font-mono text-sm font-bold hover:underline"
  >
    <UnpicImage
      src={resolveImageSrc(`logos/small/${slug}.png`)}
      alt={`${name} logo`}
      width={24}
      height={24}
      class={`flex-shrink-0 border border-default ${blackBackgroundSlugs.includes(slug) ? 'bg-black' : 'bg-surface'}`}
    />
    <span class="flex-1 leading-snug break-words whitespace-normal">{name}</span
    >
  </a>
  <div class="flex flex-wrap gap-1">
    {
      tags.map((tag) => {
        const styles = getTagStyle(tag);
        return (
          <span class={styles.container}>
            <span class={styles.dot} />
            {tag.toLowerCase()}
          </span>
        );
      })
    }
  </div>
</div>
