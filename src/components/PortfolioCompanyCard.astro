---
import clsx from 'clsx';
import { Image as UnpicImage } from '@unpic/astro';
import { resolveImageSrc } from '../lib/images';

interface Props {
  name: string;
  url: string;
  tags: string[];
  slug: string;
  showTags?: boolean;
}

const { name, url, tags, slug, showTags = false } = Astro.props;

// Companies that need black background for their logos
const blackBackgroundSlugs = ['beta'];

type TagColors = {
  [key: string]: string;
};

const dotColor = 'bg-pwv-soft-periwinkle';

const dotColors: TagColors = {
  'ðŸ¦„': 'bg-fuchsia-600',
  aerospace: dotColor,
  hardware: dotColor,
  energy: dotColor,
  'dev tools': dotColor,
  ai: dotColor,
  saas: dotColor,
  construction: dotColor,
  'board seat': dotColor,
  'board seat (past)': dotColor,
  biotech: dotColor,
  'food tech': dotColor,
  cad: dotColor,
  'quantum computing': dotColor,
  acquired: 'bg-pwv-green',
};

// Helper function to get tag styles based on category
const getTagStyle = (tag: string) => {
  const baseStyle =
    'text-xs inline-flex items-center mx-1 gap-1.5 px-3 py-1 rounded-full  text-sm border border-pwv-gray';
  return {
    container: baseStyle,
    dot: `w-1.5 h-1.5 rounded-full ${dotColors[tag.toLowerCase()] || 'bg-pwv-soft-periwinkle'}`,
  };
};
---

<div class="flex flex-col gap-2 overflow-hidden py-1">
  <a
    href={url}
    target="_blank"
    rel="noopener noreferrer"
    class="text-primary flex min-w-0 items-center gap-3 font-mono text-sm font-bold hover:underline"
  >
    <UnpicImage
      src={resolveImageSrc(`logos/small/${slug}.png`)}
      alt={`${name} logo`}
      width={32}
      height={32}
      class={`flex-shrink-0 p-0.5 border border-pwv-gray ${blackBackgroundSlugs.includes(slug) ? 'bg-black' : 'bg-surface'}`}
    />
    <span class="flex-1 text-lg leading-snug break-words whitespace-normal"
      >{name}</span
    >
  </a>
  {
    showTags && (
      <div class="flex flex-wrap gap-1">
        {tags.map((tag) => {
          const styles = getTagStyle(tag);
          return (
            <a
              href={`/portfolio?tags=${encodeURIComponent(tag.toLowerCase())}`}
              class={styles.container}
            >
              <span class={styles.dot} />
              {tag.toLowerCase()}
            </a>
          );
        })}
      </div>
    )
  }
</div>
